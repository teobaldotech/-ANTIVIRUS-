<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Antiv√≠rus Simples</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-color: #f4f4f4; }
    h1 { color: #333; }
    .safe { color: green; }
    .danger { color: red; }
    .card { background: #fff; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; }
    #historico { margin-top: 30px; }
    ul { list-style: none; padding: 0; }
    li { background: #fff; padding: 10px; margin-bottom: 5px; border: 1px solid #ccc; }
  </style>
</head>
<body>

  <h1>üõ°Ô∏è Antiv√≠rus Simples</h1>
  <p>Selecione arquivos de texto para escanear:</p>
  <input type="file" id="fileInput" accept=".txt" multiple>
  <button onclick="escanearArquivos()">Escanear</button>

  <h2>üîç Resultados:</h2>
  <div id="resultados"></div>

  <div id="historico">
    <h3>üóÇÔ∏è Hist√≥rico de Escaneamentos</h3>
    <ul id="listaHistorico"></ul>
    <button onclick="limparHistorico()">üßπ Limpar Hist√≥rico</button>
  </div>

  <script>
    const palavrasSuspeitas = ["virus", "trojan", "malware", "worm", "hacker"];

    function normalizar(texto) {
      return texto.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
    }

    function escanearArquivos() {
      const input = document.getElementById('fileInput');
      const resultados = document.getElementById('resultados');
      resultados.innerHTML = "";

      if (!input.files.length) {
        resultados.innerHTML = "<p class='danger'>Nenhum arquivo selecionado.</p>";
        return;
      }

      Array.from(input.files).forEach(arquivo => {
        const leitor = new FileReader();

        leitor.onload = function(e) {
          const conteudoOriginal = e.target.result;
          const conteudo = normalizar(conteudoOriginal);
          const encontradas = palavrasSuspeitas.filter(p => conteudo.includes(p));
          const risco = encontradas.length === 0 ? "Baixo" :
                        encontradas.length <= 2 ? "M√©dio" : "Alto";

          const resultado = document.createElement("div");
          resultado.className = "card";
          resultado.innerHTML = `<strong>${arquivo.name}</strong><br>
            Palavras suspeitas: ${encontradas.join(', ') || 'Nenhuma'}<br>
            Risco: <span class="${risco === 'Baixo' ? 'safe' : 'danger'}">${risco}</span>`;

          resultados.appendChild(resultado);
          salvarNoHistorico(arquivo.name, encontradas, risco);
          mostrarHistorico();
        };

        leitor.readAsText(arquivo);
      });
    }

    function salvarNoHistorico(nomeArquivo, palavrasEncontradas, risco) {
      const historico = JSON.parse(localStorage.getItem("historico")) || [];
      historico.push({
        nome: nomeArquivo,
        data: new Date().toLocaleString(),
        palavras: palavrasEncontradas,
        risco
      });
      localStorage.setItem("historico", JSON.stringify(historico));
    }

    function mostrarHistorico() {
      const lista = document.getElementById("listaHistorico");
      const historico = JSON.parse(localStorage.getItem("historico")) || [];
      lista.innerHTML = "";

      historico.slice().reverse().forEach(item => {
        const li = document.createElement("li");
        li.innerHTML = `<strong>${item.nome}</strong> - ${item.data}<br>
          Risco: <span class="${item.risco === 'Baixo' ? 'safe' : 'danger'}">${item.risco}</span><br>
          Palavras: ${item.palavras.join(', ') || 'Nenhuma'}`;
        lista.appendChild(li);
      });
    }

    function limparHistorico() {
      localStorage.removeItem("historico");
      mostrarHistorico();
    }

    // Mostrar hist√≥rico ao carregar
    window.onload = mostrarHistorico;
  </script>

</body>
</html>